Опросник Java от стажера до TechLead-a
=======

Вопросы обо всем
-----------

Как пользоваться разделом: вопросы задаются от и до в зависимости от уровня при необходимости (то есть вопросы для джуна включаются в беседу с сеньером)

1. (джава школа / стажер)
    * Зачем идешь в джава-школу/джаву/к нам? Какие планы после школы/стажировки?
    * Какие книги/статьи/каналы смотришь/читаешь?

2. (джун)
    * Расскажи о текущем месте работы, текущем проекте, чем занимаешься?
    * В каком % соотношении хочется заниматься фронт-эндом, бэк-эндом, хранилищем, инфраструктурой?
    * Какой был самый интересный опыт. Что самое интересное ты делал в рамках программирования?
    * Какая текущая зп (нэт)?
    * Какая желаемая зп (нэт)?
    
3. (мидл)
    * Как происходила разработка архитектуры? Кто принимал решения?
    * Какая твоя роль в команде? Как построено взаимодействие внутри команды (аналитики, QA, РП, РО/заказчик)
    * Кто ставил/декомпозировал/принимал/ревьюил задачи?
    * Как выглядел процесс разработки (что происходит вокруг)?
    * Кто занимался конфигурация стэндов (сервер, бд, ci/cd)?
    
4. (сеньер)
    * Чем конкретно занимался? Какая была самая сложная/интересная задача, самый большой провал? 
    * Все ли устраивает в рамках текущей роли? Куда хочется двигаться и почему? Чем хочется заниматься: кодировать или управлять?
    * Как происходила настройка производительности (клиент, джава, объемы бд, нагруженность на сервисы/бд)?
    * Были ли какие-либо проблемы в процессах (разработка, тестирование)? Что было не так? Чтобы бы ты изменил?
    * На новом месте работы вам дали на реализацию задачу объемом ~ 200ч/д (оценивал всеми уважаемый ветеран-аналитик). У вас в команде есть 1 джуниор (совсем «зеленый») и 1 мидл (с претензией на серьера). Дедлайн определен. Нужен план на первый месяц/спринт и квартал. Расскажите, что вы будете делать на протяжении реализации задачи, при условии, что вас отпустили в самостоятельное плавание от и до.
        - ![](../resources/warning.svg "warning") Ожидаемые вопросы:
            * Общие вопросы:
                - Зафиксированы ли требования?
                - Корректна ли оценка?
                - Подтверждение скоупа. Приоритизация. На что коммититься?
                - Анализ текущего решения, конкурентный анализ – что есть на рынке?
            * Погружение: 
                - Кто и как декомпозирует задачу?
                - Кто занимается проработкой архитектуры, нужно ли ее проговорить с корп архитектором?
                - Нужно ли произвести контент для системы/первоначальная конфигурации – его тип/состав/размер может влиять на архитектурные решения?
                - Кто и как будет тестировать (СТ, ИФТ, ПСИ)?
                - Проведение показов, сбор фидбэка, участие заказчика в тестировании, общение со стейкхолдерами
                - Сайзинг (бюджет, нагрузка)
                - Как внедрять и сопровождать?
                - Что делать, если «все пошло не так»?
            * Про людей:
                - Кто эти люди в команде?
                - Насколько самостоятельна команда и как часто нужно контролировать?
                - Как часто нужно давать статус руководителю?
                - Достаточно ли команда мотивирована на достижение результата? Как ее замотивировать?
                - Овертайм?
                - Найм (бюджет, оснащение рабочих мест) – ресурсный план?

5. (лид/менеджер)
    * Публичная жизнь. Доводилось ли презентовать архитектуру, план, проект, результаты, давать отчетность?
    * Кто решал конфликты в команде?
    * Планирование спринта. Формирование стаканов, мощность команды. Приортизация. Дедлайн. Кто ставил/декомпозировал требования, контролировал выполнение?
    * Кто обеспечивает коммуникацию между бизнесом/бизнес-аналитиком – (системным аналитиком)? – разработчиком - тестированием. Стендапы?
    * Кто принимал архитектурные решения ?
    * Обеспечение тестирования. Кто, как и когда тестирует? Как тестер узнает что ему тестировать?
    * Если бы тебя в моменте убрали из команды на 2 недели, что бы сломалось?
    * Процессы в компании/команде? Какие были, в чем отличия?
    * Материальное обеспечение: техника, печеньки, лицензии. Кто и как этим занимался?
    * Найм и команда: кто уходил, почему? пытались ли удержать? Увольняли ли? Переманивание. Какие вопросы на собеседовании задаешь? Сколько интервью идет по времени? Задачки? Кто обеспечивает поток резюме? Скайп?
    * Пришел бизнес и сказал, что надо СЕЙЧАС сделать фичу, оценка бизнеса – 1 день, оценка разработки – полспринта. Что делать?

Теория
-----------

1. Core java
    * Абстрактный класс
        - Какое ключевое отличие абстрактного класса от интерфейса?
    * Коллекции. List-Set-Map-Queue
        - Интерфейсы и имплементации, иерархия
        - Как устроена HashMap?
        - Есть ли альтернативы <span style="color:orange">(guava – immutable, apache - sync)</span>? Зачем они нужны?
        - Ограничение TreeSet <span style="color:orange">(comparable)</span>, ограничение HashSet <span style="color:orange">(hashcode + equals)</span>
        - Что будет с HashSet, если hashcode возвращает константу или рандомное число?
    * Generics
        - Зачем, в чем их польза?
        - Что значит “Т extends Object” и “T super Object”, когда что писать? Есть ли правило на этот счет <span style="color:orange">(PECS)</span>?
        - Необходимо реализовать некую иерархическую структуру (например, дерево с числами в узлах) и написать метод обхода узлов
    * Garbage collection
        - Какие гипотезы лежат в основе работы gc? <span style="color:orange">(есть 2 типа объектов: маложивущие и долгоживущие; причем маложивущих объектов много, долгоживущих мало)</span>
    * Исключения
        - Типы исключений <span style="color:orange">(checked/unchecked)</span>. Иерархия. Зачем нужен Error?
        - Можно ли перехватить RuntimeException, Error, Throwable?

2. XML / JSON
    * Какие способы разобрать XML в Java вы знаете? В чём отличия? Опыт использования <span style="color:orange">(DOM, SAX, StAX, XPath, regexp, substring)</span>

3. DI & transaction demarcation: Spring/EJB/MDB
    * IoC, DI зачем нужно? Какие задачи решают Spring Framework/EJB? <span style="color:orange">(low coupling)</span>. Чем/где это помогает <span style="color:orange">(упрощает тестирование)</span>?  
    * Управление транзакциями: потенциальные проблемы, уровни изоляции, deadlocks и тд

4. Test
    * Писали ли вы unit/интеграционные-тесты?
    * Когда нужно писать тесты?
    * Какими библиотеками пользовались (JUnit, TestNG. EasyMock, Mockito, SoapUI, JMeter)? Как организовать тесты (unit, integration)
    * Использование Mock-ов. Зачем они нужны?

5. SQL

6. Linux & shell scripting

7. Git

8. MAVEN
    * Как собрать проект в параллель <span style="color:orange">(-T1C, mvn –help, google)</span>?

9. Общие вопросы 
    * Через браузер зашли на сайт яндекса, ввели в поиск любой набор символов и нажали «Поиск». Что происходит дальше? (TLS, HTTP(S) over TCP/IP)
    
Задачи
-----------

1. Задачи на написание кода
    * Задача 1: Определите структуру данных для сбалансированного бинарного дерева (или возьмите готовую). В каждом узле дерева хранится число (int). Напишите функции:
        - обхода всего дерева (нужно побывать в каждом узле 1 раз) и вывода в консоль значения каждого узла, в котором мы побывали.
        - Добавления нового элемента
    * Задача 2: 
      
        ```
        /**
        * Реализуйте функцию, которая для данного массива целых чисел (int[]) возвращает значение наиболее близкое к 10.
        * Если существует два одинаково близких значения (например, 8 и 12), считайте больше значение более близким.
        */
       ```  
      
    * Задача 3: 
      
        ```
        /**
        * Сравните объём памяти, который будет использован в результате исполнения данных участков кода:
        */
        
        public static final int MAX = 1024*1024;
        
        List<Integer> list = new ArrayList<Integer>(MAX);
        for (int i = 0; i < MAX; i++) {
            list.add(i);
        }
        
        List<Integer> list = new LinkedList<Integer>();
        for (int i = 0; i < MAX; i++) {
            list.add(1);
        }
        ```

2. SQL
   
```
/** 
* Таблица CUR_RATES
*
* ID   CUR        RATE          DATE
* 1    RUR      1.0000    01.01.1970
* 2    USD     65.3200    01.10.2015
* 3    USD     64.6500    02.10.2015
* 4    USD     64.3100    05.10.2015
* 5    ZWL      0.0100    01.01.2015
* 
* Note: действующие курсы валют есть на каждый день, однако, назначаются они не каждый день (в выходные, например, не назначаются). Например, 04.10.2015 – воскресенье, курс не назначается, но действует курс от 02.10.2015 (последний назначенный).
*
* 1.  По таблице написать запрос, возвращающий список валют, для которых есть хотя бы одна запись.
* 2.  Напишите запрос, возвращающий список валют, для которых есть больше 2 записей.
* 3.  Напишите запрос, возвращающий курсы всех валют, действующие на заданную дату, например, "04.10.2015"
*
* По ссылке можно поиграть с постгресом вживую
* https://extendsclass.com/postgresql-online.html

create table cur_rates (

    id bigserial NOT NULL,    -- PR
    cur varchar(10) NOT NULL, -- Буквенный код валюты
    cur_date date NOT NULL,   -- Курс на дату
    rate float  NOT NULL      -- Дата, на которую задан курс
);

insert into cur_rates (id, cur, cur_date, rate) values(1, 'RUR', '1970-01-01',  1.0000);
insert into cur_rates (id, cur, cur_date, rate) values(2, 'USD', '2015-10-01', 65.3200);
insert into cur_rates (id, cur, cur_date, rate) values(3, 'USD', '2015-10-02', 64.6500);
insert into cur_rates (id, cur, cur_date, rate) values(4, 'USD', '2015-10-05', 64.3100);
insert into cur_rates (id, cur, cur_date, rate) values(5, 'ZWL', '2015-10-01',  0.0100);

select * from cur_rates;

*/
```

![](../resources/warning.svg "warning") Для интервьюера
```
select cr.cur, cr.cur_date, cr.rate
from cur_rates cr join (
    select cur, max(cur_date) as cur_date from cur_rates where cur_date <= '2015-10-04' group by cur
) x on cr.cur = x.cur and cr.cur_date = x.cur_date;
``` 
  
* Вопросы
    - Можете ли вы предложить доработку структуры или порядка заполнения данными таблицы, чтобы упростить и ускорить процедуру получения действующего курса?
    - (оптимизация) Поможет ли индекс по полю CURRENCY, если по USD записей 200к, EUR – 500к, и 300к записей для остальных валют?

3. Задачи XML/JSON

```
/**
 * Вам поступило задание (ЕДИНОРАЗОВО!) разобрать XML файл следующего формата размером порядка 10...30 Мб и выгрузить результаты в файл для последующего анализа:
 * 
 * 1. Оцените трудоёмкость этой задачи.
 * 2. Каким образом вы будете данную задачу решать?
 */ 

<xml>
    <!-- any tags -->
    <!-- на любом уровне вложенности -->
    <issue type="bug">
        <issue type=”bug”>
            <!-- any tags -->
            <!-- на втором уровне вложенности относительно issue! -->
            <resolver id="1">НУЖНЫ ЭТИ ЗНАЧЕНИЯ</resolver>
            <issue type=”bug”>
                <resolver id=”2”>НУЖНЫ ЭТИ ЗНАЧЕНИЯ</resolver>
            </issue>
        </issue>
    </issue>
    <!-- игнорируем -->
    <resolver id=”3”> это значение нам не интересно</resolver>
    <issue type=”bug”>
        <resolver id=”4”>это значение нам не интересно</resolver>
    </issue>
    <!-- any tags -->
</xml>

или

{	
    /* any fields */
    /* на любом уровне вложенности */
	“issue”: {
		“type” : ”bug”
		“issue” : {	
		    “type” : ”bug”
		    /* any fields */
		    /* на втором уровне вложенности относительно issue! */
			“resolver” : { “id” : “1” “value” : “НУЖНЫ_ВОТ_ЭТИ_ЗНАЧЕНИЯ” }
            “issue” : {
				“type” : ”bug”
				“resolver” : { “id” : “2” “value” : “НУЖНЫ_ВОТ_ЭТИ_ЗНАЧЕНИЯ” }
            }
        }		
    } 
    /* игнорируем */
    “resolver” : { “id” : “3” “value” : “это значение не интересно” }
	“issue” : {
		“type” : “bug”
		“resolver” : { “id” : “4” “value” : “это значение не интересно” }	
    }
} 
```


4. Hibernate
    * Как написать такой запрос: 
        - Таблицы и связи: organizations( 1M ) 1-----N departments( 10M ) 1-------N persons( 100M )
        - есть список id 1500 организаций(СПИСОК) нужно получить следующие данные: “organizations.name, departments.name, persons.name, persons.salary” где organizations входят в СПИСОК и salary > 100000

    * Как организована работа entity (жизненный цикл, lazy-loading)? <span style="color:orange">Proxy-классы</span>	
    * Как правильно реализовать equals / hashcode <span style="color:orange">(так как entity по факту прокси, то проверку на class сделать непросто)</span>
    
5. Spring
    * Теория 
        - Как устроен DI контейнер?
        - Работает ли @Transactional в init – методе?
        - Зачем спринговые бины имплементрируют интерфейсы? Инжект бина по классу. Реализация интерфейса без методов.
        - Как реализовать инжекты бинов разных скоупов <span style="color:orange">(@Lookup / self-inject, ProxyMode, context-inject)</span>
    * Практика
        - Есть спринговый сервис. При старте приложения хочется прогреть кэш. Есть ли проблемы с этим кодом? Предложите свой вариант.

        ```
        package ru;
        
        import javax.annotation.Nonnull;
        import javax.sql.DataSource;
        
        
        /**
         * Коллеги из команды прислали на ревью следующий код, суть которого - выполнение некоторой бизнес-логики с оптимизацией на базе кэша.
         * Какие у вас есть замечания к этому коду?
         */
        @Service
        /* package */ class MyServiceImpl {
        
            @Autowired
            private DataSource ds;
        
            /* package */ MyServiceImpl() {
                //"разогреем" кэш при старте приложения
                warmCache(ds.getConnection());
            }
        
            private void warmCache(@Nonnull final Connection c) {
                //суть "разогрева"
                //final NamedJdbcTemplate template = new NamedJdbcTemplate(ds);
                //final Map cache = template.executeAsMap("select ... from data");
                //template.update("update statistics set cache_update_count = cache_update_count + 1");
                ...
            }
        
            ...
        }
        
        @Configuration
        @EnabledTransactionManagment
        public class Cfg {
        
            @Bean 
            public DataSource ds() {
                final DataSource ds = new ...;
                return ds;
            }
        
        } 
        ```
      
        
6. Транзакции и многопоточность

```
/**
 * В вашей программе в одном из режимов, в котором пользователи пачками подтверждают запросы от клиентов, 
 * пользователи начали испытывать некоторые трудности. С какого-то момента операция подтверждения начала занимать значительное время, 
 * а иногда появляется невнятная ошибка, при которой запросы не подтверждаются. 
 * Предположим, есть следующий код, который выполняет некую бизнес-логику и меняет статус обработки на записях в БД в транзакционной манере. 
 * Код используется в высококонкурентной среде, зачастую объёмы обрабатываемых данных пересекаются. Изучите данный код на наличие проблем и, 
 * если таковые имеются, предложите их решение.
 */
 
@Service 
public class SomeOperationsService { 
 
    private final NamedJdbcTemplate namedJdbcTemplate; 
     
    @Slf4j 
    @Transactional(Propagation.REQUIRED) 
    public void doSomeOperations(Set<Long> ids) {
        try {
            for (long id : ids) { 
                ...   // business logic
                beforeUpdate(id);      
                ... update some_table set …. where id = :id  // jdbc update 
                afterUpdate(id);
                ...
            }
        } catch (final Exception ex) {
            log.error("Oops, cant do some operations", ex);
            throw ex;
        }
    }
     
    /* Обработка id с бд и без */
    private void beforeUpdate(final Long id) {…}
    
    /* Обработка id с бд и без */
    private void afterUpdate(final Long id) {…}

}
```

![](../resources/warning.svg "warning") Для интервьюера. Ошибки в логах
```
PSQLException: ERROR: deadlock detected
ConnectionTimeoutException
```

7. Code review

Предположим, вы дали задание Junior-программисту написать метод, который будет возвращать число ближайшее к 10, в заданном массиве. Причем, если слева и справа найдены числа, находящиеся на одинаковом расстоянии, то необходимо возвращать то, что справа. Через некоторое время довольный собой Junior принес вам на ревью следующий код, дайте свои замечания.

* Вариант 1

```
public static final int getClosest2Ten(int[] array){
    Integer currElement;
    Integer min = 0;
    for(int i = 0; i < array.length; i++){
        currElement = array[i];
        if(Math.abs(currElement - 10)<Math.abs(min-10))
            min = currElement;
        else if ((currElement-10)== Math.abs(10-min))
            min = min>10?min:currElement;
    }
    return min;
}
```

* Вариант 2

```
public static final int getClosest2Ten(final int[] numbers) {
    Arrays.sort(numbers);
    final int indexOfSearchKey = Arrays.binarySearch(numbers, 10);
    final int leftIndex  = Math.max(-indexOfSearchKey - 2, 0);
    final int rightIndex = Math.max(-indexOfSearchKey - 1, 0);
    return indexOfSearchKey >= 0? 10: closest2Ten0(numbers[leftIndex], numbers[rightIndex]);
}
```

* Вариант 3

```
public static final int getClosest2Ten(final int[] array) {
    final IntStream stream = IntStream.of(array);
    final OptionalInt left  = stream.filter(num -> num <= 10).max();
    final OptionalInt right = stream.filter(num -> num >  10).min();
    return closest2Ten0(left.getAsInt(), right.getAsInt());
}
```

* Общее 

```
private static final int closest2Ten0(final int left, final int right) {
    return right - 10L <= 10L - left ? right : left;
}

//test it
public static void main(String[] args) {
    System.out.println(getClosest2Ten(new int[]{6, 5, 8, 12, 15, 0}));
}
```

8. Задачи на проектирование

```
/** 
 * Наши разработчики подготовили сервис следующего вида. 
 * 
 * production представляет собой 1 ядро х64 и 2Гб RAM
 * 
 * После установки в production, в связи с ростом количества запросов мы столкнулись с проблемой нехватки ресурсов CPU. 
 * Предполагая, что getPiInternal уже оптимизирован по памяти/CPU, 
 * 
 * предложите решение с разумной трудоёмкостью, с помощью которого можно снизить нагрузку на CPU/повысить отзывчивость системы, 
 * при этом не внеся в систему новых проблем/ошибок и реализуйте его.
 */
 
/**
 * precision    result      Распределение
 *         0    3           90%
 *         1    3.1    
 *         2    3.14    
 *         3    3.141    
 *         4    3.1415    
 *         …    …    
 *     50000    3.1415………   8%    
 *         …    …           
 *    100000    3.1415………   2%     
 *         …    …           
 */ 
 
/** Сервис, вычисляющий число Pi. */
public class PiService {
 
    public String getPi(long precision) { // <<-- оптимизируем этот метод
 
        return getPiInternal(precision);
    }

    /** нативный метод вычисляет Pi до precision знака и возвращает в виде строки */
    private native String getPiInternal(long precision);
}

```

		
9. Задачи на проектирование
    * Задача 1:
        - Вам поручено разработать новую интеграцию с системой Х. Известно, что заказчик доработки хочет, чтобы системы обменивались примерно 10-20 типами структур с бизнес-данными, каждая структура имеет до 3-4 уровней вложенности (например, organization->departments->employees). Техническое задание ещё не разрабатывалось.
        - Необходимо: Определить технологии, форматы и методики, которые вы будете использовать при интеграции с системой Х.
        - Интервьюер исполнит роль заказчика, которому вы можете задавать необходимые вопросы.
        - Постарайтесь предусмотреть на этапе проектирования и избежать потенциальных будущих сложностей/несоответствий которые могут возникнуть при разработке/эксплуатации решения.

    * Задача 2: 
        - Заказчик хочет сделать интеграцию двух систем (планируется обмен несколькими сообщениями). Какие вопросы вы бы ему задали? Какие технологии использовали бы?
            * ![](../resources/warning.svg "warning") Ожидаемые вопросы:
                - Доступность систем?
                - Предполагаемая нагрузка?
                - Режим работы систем?
                - Что находится с другой стороны? (например, если с другой стороны микроконтроллер, то он не сможет обработать тяжелый запрос)

    * Задача 3: 
        ```
        /**
        *   A  -------> B
        *    Много (до 10кк) маленьких (до 1кб) сообщений в сутки
        *
        *    A <-------- B
        *    Одно большое сообщение (список сообщений за квартал)
        */
        ```

10. Troubleshooting
    * Задача 1 2 3:
        - Команда в ~30 человек, выполнено 1000 чел*дней доработок с предыдущего релиза. Спустя 4 часа после установки в продакшн выявилась проблема:
        - Варианты:
            * ошибки в настройках в pool’е недостаточно соединений. Соединения в pool’е не работают. <span style="color:orange">(ConnectionWaitTimeoutException)</span>
            * Случился OOM в 3 часа ночи. Вам звонят и сообщают о проблеме. Ваши действия?
            * Разработчики выкатили новую версию. На тесте все ОК, на проде тормозит. Надо срочно исправить проблему. Ваши действия?
    