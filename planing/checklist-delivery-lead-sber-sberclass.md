Чек лист delivery manager / PM
===========

<a name="dev-lead-up"></a>Подготовка к разработке
-----------

1. Определить delivery manager по задаче
   
2. Определите участников команды со следующими ролями:
    * бизнес-архитектор
    * [product Owner (PO)](https://confluence.pcbltools.ru/confluence/x/tZmAAg) / [БА](https://confluence.pcbltools.ru/confluence/x/-aGXAg)
    * дизайнер
    * Системный аналитик
    * разработчики BE/FE
    * QA
    * представитель команды сопровождения
    * представитель информационной безопасности (ИБ)
    * технический архитектор
    * инфраструктурный архитектор

3. Определите зоны ответственности каких команд затрагивает доработка
    * Если речь про команды "внутри" кластера (под единым руководством), то сделать это можно проанализировав зоны ответственности на странице [Команды](https://confluence.pcbltools.ru/confluence/pages/viewpage.action?pageId=12716735). Если нескольких команд, то нужно создать в Jira тикеты с типом "Change Request" и назначить на PO/ITL ответственной команды. Необходимо показать эти тикеты PO/ITL и в явном виде получить от них обратную связь/согласование
    * Если речь про команды "снаружи" кластера (команды других отделов/департаментов/компаний, например, VK), то найти представителя (аккаунт-менеджера) и поставить задачи через него
   
4. Составить матрицу коммуникаций с конкретными ФИО и контактами (телефон + почта)
   
5. PO вместе с бизнес-аналитиком должны подготовить бизнес-требования к доработке. Definition of Done (DoD) для БТ:
    * указана проблематика и мотивация доработки: для чего нужна, какие проблемы она решает
    * описаны сценарии использования
    * зафиксированы и согласованы всеми стейкхолдерами критерии приёмки
    * зафиксированы бизнес-метрики
    
6. TL вместе с аналитиком должны разбить бизнес-требования на story
    * Все story необходимо создать в jira и собрать в epic
    * FixVersion для story необходимо выбирать ориентируясь на [календарь релизов](https://jira.pcbltools.ru/jira/secure/DoItBetterCalendar.jspa)
    * Если команда живёт по одной из agile-методологий, то оценка story должна укладываться в sprint

7. Перед началом разработки story необходимо пройти набор условий [Definition Of Ready (DoR)](https://confluence.pcbltools.ru/confluence/x/k7EUAg)
    * аналитик должен подготовить системные требования в соответствии с шаблоном и чеклистами. Системные требования должны включать макеты, согласованные с PO и командой, которая будет работать по story
    * Сделать оценку этих story для всех этапов и участников процесса. В случае необходимости при оценке стоит:
        - Заложить оценку чистой разработки по всем пунктам плана (состав доработки)
        - Заложить оценку на аналитику (коэффициент 0.3) и тестирование (коэффициент 0.3)
        - Заложить риски и неопределенности (коэффициент 1.0)
        - Заложить оценку интеграции с внешними системами (оценивать отдельно и очень осторожно)
        - Заложить еще 2 недели "сверху" (так как за 2 недели можно сделать все что угодно)
        - ![](../resources/warning.svg "warning") Например, если чистая оценка составляет 10 чд, то оценка всей задачи будет вычисляться как 10d*(1 + 0.3 + 0.3 + 1.0) + 2w = 10d * 2.6 + 2w = 36d
        - ![](../resources/warning.svg "warning") При этом важно заложить отпуска, болезни и увольнения (коэффициент 1,15) при расчете capacity команды (не story !!!)
    * архитектор/techlead должны подготовить архитектуру решения и обновить архитектурные артефакты системы в целом  
    * Необходимо получить согласования от смежных команд на эту доработку
    * Необходимо получить согласование от ИБ
    * Необходимо получить согласование от сопровождения
   
8. Необходимо подумать о дополнительных расходах, которые могут потребоваться до, во время и после внедрения доработки:
    * (До)
        - железо: 
            * ноутбуки / АРМ, мониторы для разработчиков
            * iMac/планшеты/стилусы для дизайнеров
            * телефоны/планшеты(android/ios) и другие устройства для тестирования
            * КТС для дев стендов
        - софт: 
            * IDE (лицензии)
            * jira (+ zephyr, script runner)/confluence/jenkins/sonar/checkmarks/nexus/harbor/rancher или аналоги  
            * конфигурация АРМ, доступы в необходимые информационные системы
            * xml/uml/bpmn и прочие редакторы для аналитиков/архитекторов/проектировщиков
            * figma/miro/storybook для дизайнеров и РО
            * browserstack для тестирования в разных средах  
            * slack (или любое другое средство оперативной коммуникации)
        - остальное:
            * рабочие места, столы, стулья
            * доступ в интернет (wifi, провода)
            * горячая еда 2-3 раза в день, холодные закуски
        - команда разработки: 
            * найм
    * (Во время)
        - КТС для stage и prod (+ георезерв) контуров
        - Расширение команды сопровождения
        - Мониторинг/Метрики
            * почтовые провайдеры 
            * смс провайдеры
            * системы мониторинга и логирования (Splunk, EFK, Zabbix или аналоги)
        - Технические средства для пользователей 
            * железо: 
                - компы, ноутбуки, планшеты, мобильные устройства
                - роутеры для доставки интернета
        - Информационная поддержка 
            * обучение
            * реклама 
            * презентация 
            * PR
    * (После)
            
9. Необходимо (определяется сопровождением на этапе DoR) подготовить план реализации, внедрения и тиражирования функционала:
    * технические моменты 
        - Предусмотреть вывод сервиса(-ов)/функционала за фича-флагом
        - Предусмотреть разработку, дебаг, работу, тестирование сервиса(-ов)/функционала локально, на дев/тест стендах, stage и prod средах
        - Предусмотреть вывод сервиса(-ов)/функционала без необходимости вывода других сервисов
        - Предусмотреть выход сервиса(-ов)/функционала без downtime
        - Предусмотреть выход сервиса(-ов)/функционала строго обратносовместимо
    * организационные моменты 
        - Подготовить [`план тестирования`](#test-lead-up) (на дев, stage, prod средах)
            * в том числе, тестирование конфигурации 
            * в том числе, проверка полноты формулирования и применения release notes (SM)
            * в том числе, правильное распределение ДО/ВО ВРЕМЯ/ПОСЛЕ задач в release notes 
            * в том числе, функциональных и нефункциональных требований
            * в том числе, деплой и откат
        - Подготовить план настройки инфраструктуры
        - Подготовить планы деплоя и отката сервиса(-ов)/функционала
        - Предусмотреть перенос изменений во все необходимые ветки гита (как минимум, релизная ветка и master)
        - Определить формат релиза функционала
            * общий или отдельный релизный цикл сервисов
            * совместный или отдельный pipeline выкатки продуктов 
        - План обязан содержать сроки/тайминг выполнения пунктов и фамилии конкретных ответственных за выполнение пунктов
        - План должен быть зафиксирован в соответствующей задаче Release 2.0 (для stage и prod сред)
        - План должен быть согласован с сопровождением 
    
10. Обеспечить заключение юридических договоров (если нужно)
   
Ключевой критерий завершения подготовительного этапа: 
* собрана необходимая команда
* подготовлены необходимые артефакты
* у команды не осталось вопросов по задаче

<a name="test-lead-up"></a>Подготовка к тестированию
-----------

1. Подготовить окружение для локального/дев/stage тестирования:
   * Зафиксировать и согласовать Бизнес-сценарии
   * Подготовить тест-кейсы
      - ![](../resources/warning.svg "warning") если ТК "портит" данные, то должен быть инструмент, который "восстанавливает" испорченные данные или делает так, чтобы ТК можно было повторить на изначальных данных
      - ![](../resources/warning.svg "warning") если ТК технически "сложно" воспроизвести, то должна быть инструкция в СТ
   * Подготовить дев/stage стенды для проведения тестирования 
   * ![](../resources/warning.svg "warning") Забронируйте stage для экспериментального тестирования своей story в порядке очереди
   * ![](../resources/warning.svg "warning") Забронируйте stage для нагрузочного тестирования, на котором необходимо провести НТ story
   * Подготовить необходимые доступы
   * Подготовить тестовые учетные записи (для всех ролей)
   * Подготовить тестовые данные
   * Подготовить окружение для интеграционного тестирования с внешними компаниями (если есть):
      - Контакты и доступность QA с той стороны
      - Канал оперативной(!) коммуникации
      - Тестовые стенды с той стороны
      - Доступы на ту сторону
      - Тестовые учетные записи (для всех ролей) с той стороны
      - Тестовые данные с той стороны
      - Договориться о времени тестирования (и доступности системы/стенда с той стороны)

2. Если доработка технически сложная, то необходимо как можно раньше выйти на ИФТ/stage, чтобы 
   * поймать потенциальные проблемы как можно раньше 
   * заранее настроить стенд (интеграция, сквид, бд, роутинг и тд)
   * ![](../resources/warning.svg "warning") Отдельно проверить скрипты корректировки прод дампа для наката на stage

3. Создать и начать управление тест-планом

4. Провести анализ рисков и начать управление рисками

<a name="development"></a>Разработка
-----------

1. Необходимо убедиться, что все пункты DoR для story выполнены (см ['Подготовка к разработке'](#dev-lead-up))
    * Без выполнения DoR разработку можно начинать только тогда, когда это имеет смысл

2. Необходимо отвести фича-ветку от релизной ветки, которая установлена в prod
    * Отведение от мастера допустимо только тогда, когда это имеет смысл

3. Необходимо продумать возможные изменения GQL, OpenApi (rest/swagger), бд схем (и любых других интеграционных контрактов) или любых других контрактов
    * Новые контракты должны быть согласованы всеми заинтересованными сторонами до начала разработки, чтобы не блокировать друг друга
    
4. Выполнить разработку в части бд, бек, фронт, ci/cd/инфраструктура в фича-ветке
    * За один функциональный блок должны отвечать (или работать над ним) как минимум 2 человека (парное программирование) для снижения bus-factor
    * Апи должно быть идемпотентно 
    * Контракты должны быть обратно совместимы
    * НФТ должны выполняться
    * Дополнительные требования/чек лист смотри тут: [EDU-46160 - Чек-лист технического решения](https://jira.pcbltools.ru/jira/browse/EDU-46160) и [Чеклист технического решения](https://confluence.pcbltools.ru/confluence/pages/viewpage.action?pageId=78538339)

5. При необходимости выполнить миграцию исторических данных

6. Выполнить задачи QA в параллель с разработкой:
    * ![](../resources/warning.svg "warning") Важно помнить, что "тестирование" это не просто поиск мест, которые не соответствуют требования. Это проверка качества ПО. Дефект может быть и бизнес-процессе, и в требованиях, и в коде — это все нужно проверять. Результат должен соответствовать ожиданиям заказчика.
    * Создать ручные тест-кейсы
    * Согласовать тест-кейсы с командой  
    * Актуализировать РТМ
    * Подготовить/актуализировать матрицу трассировки требований  
    * Подготовить планы тестирования 
        - ![](../resources/warning.svg "warning") обязательно для заполнения в случае "сложной" доработки - где процесс задевает более 1го сервиса
        - внутреннего интеграционного тестирования в дев-среде (план должен включать в себя: список работ/импакт анализ, сроки проведения тестирования, ответственный за проведение тестирования, план/механизм отката/выключения доработки),
            * (!) Скорее всего этот пункт можно закрыть путем подлития целевой ветки в фича-ветку и прогону на ней всех АФТ 
        - внутреннего интеграционного тестирования на stage  (план должен включать в себя: список работ/импакт анализ, сроки проведения тестирования, ответственный за проведение тестирования, план/механизм отката/выключения доработки),
        - внешнего интеграционного тестирования на stage (при необходимости) (план должен включать в себя: список работ/импакт анализ, сроки проведения тестирования, ответственный за проведение тестирования, план/механизм отката/выключения доработки), 
    * Обеспечить управление рисками 
      
7. Автоматизировать тест-кейсы из предыдущего пункта (как минимум критичные):
    * unit тесты (JUnit5, spring-test)
    * интеграционные тесты (JUnit5, spring-test)
    * апи тесты (JUnit5, spring-test)
    * end-2-end тесты (Selenium, CodeсeptJS)
    * нагрузочные тесты
    * приемочные смоук-тесты для запуска на проде

8. Необходимо установить артефакты, собранные из фича-ветки, на dev стенд.

9. Проведите тестирование story в фича-ветке на dev стенде:
    * ![](../resources/warning.svg "warning") Стараемся не переводить в тестирование отдельные сабтаски
    * Регрессионное авто тестирование
    * Регрессионное ручное тестирование 
        - в том числе тестирование развертывания (ci/cd) и инфраструктуры. Нельзя выходить на stage без подтверждения корректности конфигурации в дев
        - в том числе тестирование обратной совместимости при внедрении 
        - в том числе тестирование отката
    
10. Напишите документацию 
    * Напишите пользовательскую документацию 
        - При необходимости заведите задачу на обновление пользовательской документации
        - При необходимости написать бизнес release notes (описание нового функционала в бизнес-терминах)
    * Напишите техническую документацию
        - Напишите и/или обновите инструкции для поддержки (первая, вторая линия)
        - Напишите и/или обновите карточки сервисов
        - Напишите инструкцию по развертыванию и откату нового функционала/сервиса 
            * ![](../resources/warning.svg "warning") План должен включать в себя: список работ/импакт анализ, сроки проведения тиражирования, ответственный за проведение тиражирования, план/механизм отката/выключения доработки
            * Подготовить SM задачи на настройку stage и prod окружений в [release notes](https://confluence.pcbltools.ru/confluence/x/WNGAAg) по правилам [Release 2.0](https://jira.pcbltools.ru/jira/browse/SM-22153)
        - Напишите и/или обновите архитектурные диаграммы 
            * Компонентную диаграмму 
            * Детальную архитектуру (в том числе список лицензий и зависимостей)
            * Сетевую диаграмму 
            * НФТ 
    
11. Необходимо закрыть все пункты [Definition of Done (DoD)](https://confluence.pcbltools.ru/confluence/x/irEUAg):
    * Провести ревью архитектуры реализованного решения на соответствие заявленной
    * Провести ревью безопасности решения на соответствие заявленным требованиям  
    * Провести ревью реализованных экранных форм на соответствие макетам 
    * Провести тестирование
        - Чтобы story можно было [влить](#development-merge) в интеграционную ветку, необходимо закрыть все баги по story  
    * Провести ревью кода на соответствие стандартам компании/проекта/команды 
    * Провести ревью пользовательской документации
    * Провести ревью технической документации 
    * Подготовить и показать функционал на внутреннем демо
        - Подготовиться к демо 
            * Выбрать и подготовить стенд
            * Установить story на стенд
            * Подготовить сценарии демонстрации
                - ![](../resources/warning.svg "warning") Сценарии должны покрывать критерии приемки
            * Сформировать данные для показа
            * Выбрать тех, кто проводит demo (аналитик) и фиксирует замечания (QA)
        - Провести демо
            * Показать функционал
            * Показать документацию
            * Показать планы внедрения и отката
    * Провести демо и приемку заказчиком story
        - ![](../resources/warning.svg "warning") Организация демо заказчику аналогична внутреннему демо 
    * Согласовать планы 
        - внешнего интеграционного тестирования
        - внедрения и отката
    * Согласовать с РО, релизной командой и delivery lead срок и версию внедрения

12. <a name="development-merge"></a>Создайте pull request на [merge](https://confluence.pcbltools.ru/confluence/x/JekUAg) вашей фича-ветки в 
    * master (с целью получить лайки по PR/merge в master). Перед этим merge целевой ветки в фича-ветку, чтобы избежать конфликтов
    * целевую ветку. Перед этим merge целевой ветки в фича-ветку, чтобы избежать конфликтов
    * другие ветки (при необходимости)
    * При необходимости сделайте merge в [конфигурационный репозиторий](https://bitbucket.pcbltools.ru/bitbucket/projects/EDUPOWER/repos/devops/browse).
   
13. До наступления фича-фриза (ФФ) тикеты с типом Story должны быть переведены в статус IFT
   
14. Установите артефакты, собранные из релизной ветки с вашей фича-веткой на stage
   
15. Проведите тестирование на stage:
    * Интеграционное Функциональное Тестирование (ИФТ)
    * Нагрузочное Тестирование (НТ)
    * Тестирование на Безопасность (КБ)
    * Интеграционное Тестирование с внешними сервисами/компаниями (если необходимо)
    * UAT
    * Деплой и откат
    * Обратная совместимость
   
16. На этапах тестирования при обнаружении багов, заводятся тикеты в jira, для их исправления. 
    * По согласованию с PO/TL баги могут быть перенесены в следующие релизы. При этом необходимо заполнить поле "причина переноса" у дефектов.

Ключевой критерий завершения этапа разработки:
* DoD пройден
* До ФФ задачи переведены в статус IFT

Вывод доработки в ПРОМ среду
-----------
   
1. ДО выхода в прод необходимо:
    * завести необходимые справочные и технические данные
   
2. Вывод доработки в пром происходит вместе с релизом и выполняется релизной командой.
   
3. ПОСЛЕ выхода в прод необходимо: 
    * Включить фича-флаг для story для отдельной школы и/или отдельных пользователей, которые проверяют функционал в prod.
    * По согласованию с PO фича-флаг включается для всех
    * Мониторить функционал/систему на предмет аномалий в графиках и ошибок
    * Собрать обратную связь от пользователей
    * Провести ретроспективу проекта/внедрения story
   
4. Необходимо провести информирование пользователей о новом функционале
    * Информирование 
        - Разместить баннер и/или бегущую строку в рамках системы
        - Сделать рассылку по почте/смс 
        - PR
        - другой канал информирования
   * Обучение      
      
7. Исправления дефектов (багов и инцидентов) могут быть выведены в пром в [hotfix](https://confluence.pcbltools.ru/confluence/x/gknVAg).
  
8. При необходимости небольшие срочные доработки могут быть выведены в [минорных релизах](https://confluence.pcbltools.ru/confluence/x/EQvVAg).
 
9. Необходимо запланировать в будущие версии исправление всех оставшихся багов и techonus.



